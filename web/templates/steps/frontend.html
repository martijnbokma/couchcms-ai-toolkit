<div>
    {% set sectionTitle = 'Frontend Frameworks' %}
    {% set sectionDescription = 'Select the CSS and JavaScript frameworks you want to use.' %}
    {% include "partials/section-header.html" %}

    <form hx-post="/api/setup/step/frontend" hx-target="#wizard-content" hx-swap="innerHTML">
        {% include "partials/hidden-fields.html" %}

        {# CSS Framework Section - Using unified option-selector component #}
        {% from "partials/option-selector.html" import optionSelector %}
        {% set cssOptions = frontendOptions.css if frontendOptions else [
            {id: 'tailwindcss', name: 'TailwindCSS', description: 'Utility-first CSS framework', selected: true},
            {id: 'daisyui', name: 'daisyUI', description: 'Component library for TailwindCSS', requires: 'tailwindcss'}
        ] %}
        {% set cssSelected = css|default([]) %}
        {{ optionSelector(
            cssOptions,
            'css',
            'checkbox',
            cssSelected,
            'CSS Framework',
            '',
            '(select one or more)',
            'grid-cols-1 sm:grid-cols-2',
            null,
            'daisyui-warning',
            'checkDependency'
        ) }}

        {# JavaScript Framework Section - Using unified option-selector component #}
        {% set jsOptions = frontendOptions.js if frontendOptions else [
            {id: 'alpinejs', name: 'Alpine.js', description: 'Lightweight reactive JavaScript', selected: true},
            {id: 'typescript', name: 'TypeScript', description: 'Type-safe JavaScript'}
        ] %}
        {% set jsSelected = js|default([]) %}
        {{ optionSelector(
            jsOptions,
            'js',
            'checkbox',
            jsSelected,
            'JavaScript Frameworks',
            '',
            '(select one or more)'
        ) }}

        {% set nextButtonLabel = 'Next: AI Agents' %}
        {% set showBackButton = true %}
        {% include "partials/form-navigation.html" %}
    </form>

    <script>
        // Check dependencies when checkbox changes
        function checkDependency(checkbox, groupName) {
            const requires = checkbox.dataset.requires
            if (!requires) return

            const warning = document.getElementById('daisyui-warning')
            if (!warning) return

            if (checkbox.checked) {
                // Check if required dependency is selected
                const requiredCheckbox = document.querySelector(`input[name="${groupName}"][value="${requires}"]`)
                if (requiredCheckbox && !requiredCheckbox.checked) {
                    // Show warning
                    warning.classList.remove('hidden')

                    // Auto-select required dependency
                    if (confirm(`daisyUI requires TailwindCSS. Would you like to select TailwindCSS automatically?`)) {
                        requiredCheckbox.checked = true
                        warning.classList.add('hidden')
                    }
                } else if (requiredCheckbox && requiredCheckbox.checked) {
                    // Hide warning if dependency is selected
                    warning.classList.add('hidden')
                }
            } else {
                // Hide warning when daisyUI is unchecked
                warning.classList.add('hidden')
            }
        }

        // Check dependencies on page load
        document.addEventListener('DOMContentLoaded', function() {
            const daisyUICheckbox = document.getElementById('css-daisyui') || document.querySelector('input[name="css"][value="daisyui"]')
            if (daisyUICheckbox && daisyUICheckbox.checked) {
                checkDependency(daisyUICheckbox, 'css')
            }
        })
    </script>
</div>
