<div>
    {% set sectionTitle = 'Project Information' %}
    {% set sectionDescription = "Let's start by gathering basic information about your project." %}
    {% include "partials/section-header.html" %}

    <form hx-post="/api/setup/step/project" hx-target="#wizard-content" hx-swap="innerHTML" aria-label="Project information form">
        <input type="hidden" name="setupType" value="{{ setupType or 'simple' }}" />
        {% include "partials/hidden-fields.html" %}

        {# Project Name Field - Using unified field-group component #}
        {% from "partials/field-group.html" import fieldGroup %}
        {{ fieldGroup(
            'projectName',
            'projectName',
            'text',
            'Project Name',
            false,
            'my-awesome-project',
            projectName or '',
            true,
            '[a-z0-9-]+',
            '3',
            '100',
            '',
            'Use lowercase letters, numbers, and hyphens only. 3-100 characters.',
            '',
            false,
            'if (window.StepValidator) { window.StepValidator.validateAndUpdateUI("projectName", this.value); } else if (window.validateProjectName) { window.validateProjectName(this); }',
            false
        ) }}

        {# Project Description Field - Using unified field-group component #}
        {{ fieldGroup(
            'projectDescription',
            'projectDescription',
            'textarea',
            'Project Description',
            true,
            'A CouchCMS web application for...',
            projectDescription or '',
            false,
            '',
            '',
            '500',
            '3',
            'Brief description of your project (optional)',
            '',
            false,
            'if (window.StepValidator) { window.StepValidator.updateCounter("projectDescription", this.value.length, 500); } else if (window.updateDescriptionCounter) { window.updateDescriptionCounter(this); }',
            true
        ) }}

        {% if setupType == 'simple' %}
        {% set nextButtonLabel = 'Next: Editors' %}
        {% else %}
        {% set nextButtonLabel = 'Next: Presets (Optional)' %}
        {% endif %}
        {% set showBackButton = false %}
        {% include "partials/form-navigation.html" %}
    </form>

    <script>
        // Initialize validation and counter on page load
        // Uses centralized StepValidator if available (DRY)
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize description counter
            const description = document.getElementById('projectDescription')
            if (description && window.StepValidator) {
                const currentLength = description.value.length
                window.StepValidator.updateCounter('projectDescription', currentLength, 500)
            } else if (description && window.updateDescriptionCounter) {
                // Fallback to legacy function
                window.updateDescriptionCounter(description)
            }

            // Note: Validation is handled by StepValidator.validateAndUpdateUI() via oninput
            // This is called inline in the field-group component
        })
    </script>
</div>
