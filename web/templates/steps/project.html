<div>
    {% set sectionTitle = 'Project Information' %}
    {% set sectionDescription = "Let's start by gathering basic information about your project." %}
    {% include "partials/section-header.html" %}

    <form hx-post="/api/setup/step/project" hx-target="#wizard-content" hx-swap="innerHTML" aria-label="Project information form">
        <input type="hidden" name="setupType" value="{{ setupType or 'simple' }}" />
        {% include "partials/hidden-fields.html" %}

        <div class="form-control mb-4 sm:mb-6">
            <label for="projectName" class="label py-1 sm:py-2">
                <span class="label-text text-sm sm:text-base font-medium text-base-content">Project Name</span>
            </label>
            <input
                type="text"
                id="projectName"
                name="projectName"
                placeholder="my-awesome-project"
                class="input input-bordered w-full focus:input-primary rounded-xl text-sm sm:text-base"
                required
                aria-required="true"
                aria-describedby="projectName-help projectName-error"
                pattern="[a-z0-9-]+"
                minlength="3"
                maxlength="100"
                value="{{ projectName or '' }}"
                oninput="validateProjectName(this)"
            />
            <div id="projectName-help" class="text-xs text-base-content/60 mt-1">
                Use lowercase letters, numbers, and hyphens only. 3-100 characters.
            </div>
            <div id="projectName-error" class="text-xs text-error mt-1 hidden" role="alert" aria-live="polite"></div>
        </div>

        <div class="form-control mb-4 sm:mb-6">
            <label for="projectDescription" class="label py-1 sm:py-2">
                <span class="label-text text-sm sm:text-base font-medium text-base-content">
                    Project Description
                    <span class="text-xs font-normal text-base-content/60 ml-2">(optional)</span>
                </span>
            </label>
            <textarea
                id="projectDescription"
                name="projectDescription"
                placeholder="A CouchCMS web application for..."
                class="textarea textarea-bordered w-full focus:textarea-primary rounded-xl text-sm sm:text-base"
                rows="3"
                maxlength="500"
                aria-describedby="projectDescription-help projectDescription-counter"
                oninput="updateDescriptionCounter(this)"
            >{{ projectDescription or '' }}</textarea>
            <div class="flex justify-between items-center mt-1">
                <div id="projectDescription-help" class="text-xs text-base-content/60">
                    Brief description of your project (optional)
                </div>
                <div id="projectDescription-counter" class="text-xs text-base-content/60" aria-live="polite">
                    <span id="description-count">{{ (projectDescription or '')|length }}</span>/500 characters
                </div>
            </div>
        </div>

        {% if setupType == 'simple' %}
        {% set nextButtonLabel = 'Next: Editors' %}
        {% else %}
        {% set nextButtonLabel = 'Next: Presets (Optional)' %}
        {% endif %}
        {% set showBackButton = false %}
        {% include "partials/form-navigation.html" %}
    </form>

    <script>
        // Project name validation
        function validateProjectName(input) {
            const errorElement = document.getElementById('projectName-error')
            const value = input.value.trim()

            // Clear previous error
            errorElement.classList.add('hidden')
            errorElement.textContent = ''
            input.classList.remove('input-error')

            if (value === '') {
                return // Let HTML5 required validation handle empty
            }

            // Check pattern
            if (!/^[a-z0-9-]+$/.test(value)) {
                errorElement.textContent = 'Project name can only contain lowercase letters, numbers, and hyphens.'
                errorElement.classList.remove('hidden')
                input.classList.add('input-error')
                return false
            }

            // Check length
            if (value.length < 3) {
                errorElement.textContent = 'Project name must be at least 3 characters long.'
                errorElement.classList.remove('hidden')
                input.classList.add('input-error')
                return false
            }

            if (value.length > 100) {
                errorElement.textContent = 'Project name must be 100 characters or less.'
                errorElement.classList.remove('hidden')
                input.classList.add('input-error')
                return false
            }

            // Valid
            input.classList.remove('input-error')
            return true
        }

        // Description character counter
        function updateDescriptionCounter(textarea) {
            const count = textarea.value.length
            const countElement = document.getElementById('description-count')
            if (countElement) {
                countElement.textContent = count
            }
        }

        // Initialize counter on page load
        document.addEventListener('DOMContentLoaded', function() {
            const description = document.getElementById('projectDescription')
            if (description) {
                updateDescriptionCounter(description)
            }
        })
    </script>
</div>
