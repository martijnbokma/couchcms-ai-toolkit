<nav class="relative mb-8 py-4 sm:py-6" id="progress-indicator" hx-swap-oob="true">
    <!-- Progress Bar -->
    <div class="absolute top-6 sm:top-8 left-0 right-0 flex items-center px-2 sm:px-0">
        <div class="flex h-0.5 w-full items-center overflow-hidden rounded-full bg-base-300">
            <div
                role="progressbar"
                aria-valuenow="{{ progressPercentage }}"
                aria-valuemin="0"
                aria-valuemax="100"
                class="flex items-center justify-center self-stretch rounded-full bg-primary transition-all duration-500 ease-out"
                style="width: {{ progressPercentage }}%"
            ></div>
        </div>
    </div>

    <!-- Steps - Responsive: horizontal scroll on mobile, full width on desktop -->
    <div class="overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0 sm:overflow-visible scrollbar-hide">
        <ol class="relative flex items-center justify-between gap-1 sm:gap-2 md:gap-4 min-w-max sm:min-w-0" role="list" style="min-width: {{ totalSteps * 60 }}px;">
            {% for step in steps %}
            <li class="flex-shrink-0 sm:flex-1 flex flex-col items-center min-w-[60px] sm:min-w-0">
                {% if step.isClickable %}
                <button
                    type="button"
                    onclick="navigateToStep({{ step.num }}, '{{ step.route }}', '{{ setupType }}')"
                    class="group relative flex flex-col items-center w-full cursor-pointer focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 rounded-lg p-1 transition-all hover:opacity-80"
                    aria-label="Go to step {{ step.num }}: {{ step.label }}"
                >
                    <!-- Bullet with number/icon -->
                    <div
                        class="relative z-10 flex size-7 sm:size-8 items-center justify-center rounded-full font-semibold text-xs sm:text-sm transition-all duration-300 {% if step.isCompleted %}bg-primary text-primary-content shadow-lg shadow-primary/30 hover:bg-primary/90{% elif step.isActive %}border-2 border-primary bg-base-100 text-primary shadow-lg shadow-primary/20{% else %}bg-base-300 text-base-content/50 hover:bg-base-300/80{% endif %}"
                    >
                        {% if step.isCompleted %}
                        <svg
                            class="size-3.5 sm:size-4"
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 20 20"
                            fill="currentColor"
                            aria-hidden="true"
                        >
                            <path
                                fill-rule="evenodd"
                                d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z"
                                clip-rule="evenodd"
                            />
                        </svg>
                        {% else %}
                        {{ step.num }}
                        {% endif %}
                    </div>

                    <!-- Label - Smaller on mobile, full on desktop -->
                    <div class="mt-2 sm:mt-3 text-center">
                        <div class="text-xs sm:text-sm font-semibold transition-colors whitespace-nowrap {% if step.isActive %}text-primary{% elif step.isCompleted %}text-base-content{% else %}text-base-content/60{% endif %}">
                            {{ step.label }}
                        </div>
                    </div>
                </button>
                {% else %}
                <div class="group relative flex flex-col items-center w-full">
                    <!-- Bullet with number/icon -->
                    <div
                        class="relative z-10 flex size-7 sm:size-8 items-center justify-center rounded-full font-semibold text-xs sm:text-sm transition-all duration-300 {% if step.isCompleted %}bg-primary text-primary-content shadow-lg shadow-primary/30{% elif step.isActive %}border-2 border-primary bg-base-100 text-primary shadow-lg shadow-primary/20{% else %}bg-base-300 text-base-content/50{% endif %}"
                    >
                        {% if step.isCompleted %}
                        <svg
                            class="size-3.5 sm:size-4"
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 20 20"
                            fill="currentColor"
                            aria-hidden="true"
                        >
                            <path
                                fill-rule="evenodd"
                                d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z"
                                clip-rule="evenodd"
                            />
                        </svg>
                        {% else %}
                        {{ step.num }}
                        {% endif %}
                    </div>

                    <!-- Label - Smaller on mobile, full on desktop -->
                    <div class="mt-2 sm:mt-3 text-center">
                        <div class="text-xs sm:text-sm font-semibold transition-colors whitespace-nowrap {% if step.isActive %}text-primary{% elif step.isCompleted %}text-base-content{% else %}text-base-content/60{% endif %}">
                            {{ step.label }}
                        </div>
                    </div>
                </div>
                {% endif %}
            </li>
            {% endfor %}
        </ol>
    </div>
</nav>

{% include "partials/wizard-scripts.html" %}

<style>
    /* Hide scrollbar but keep functionality */
    .scrollbar-hide {
        -ms-overflow-style: none;
        scrollbar-width: none;
    }
    .scrollbar-hide::-webkit-scrollbar {
        display: none;
    }
</style>
